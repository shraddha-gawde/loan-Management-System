<head>
  <link
    href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
  />
</head>

<body id="page-top">

  <div id="wrapper">
    <!-- Sidebar -->
    <ul
      class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion"
      id="accordionSidebar"
    >
      <!-- Sidebar - logo -->
      <a
        class="sidebar-brand d-flex align-items-center justify-content-center"
        routerLink="/sellerDashboard"
      >
        <div class="sidebar-brand-icon rotate-n-15">
          <i class="fas fa-laugh-wink"></i>
        </div>
        <div class="sidebar-brand-text mx-3">Seller</div>
      </a>

      <!-- Divider -->
      <hr class="sidebar-divider my-0" />

      <!-- Nav Item - Dashboard -->
      <li class="nav-item" [ngClass]="{ active: showDashboard }">
        <a
          class="nav-link"
          (click)="
            showDashboard = true;
            showPrograms = false;
            addPrograms = false;
            showinvoices = false;
            genarateReport = false
          "
          class="nav-link cursor-pointer"
        >
          <i class="fa fa-tachometer" aria-hidden="true"></i>
          <span>Dashboard</span></a
        >
      </li>


      

      <li class="nav-item" [ngClass]="{ active: showPrograms }">
        <a
          class="nav-link"
          (click)="
            showDashboard = false;
            showPrograms = true;
            addPrograms = false;
            showinvoices = false;
            batchTable = true;
            refreshData();
            showSerchData = false;
            genarateReport = false
          "
          class="nav-link cursor-pointer"
        >
          <i class="fa fa-cog"></i>
          <span>Show All Programs</span>
      </a>
      </li>

      <!-- Nav Item - Pages Collapse Menu -->

      <li class="nav-item" [ngClass]="{ active: addPrograms }">
        <a
          class="nav-link"
          (click)="
            showDashboard = false;
            showPrograms = false;
            addPrograms = true;
            showinvoices = false;
            showInvoice();
            genarateReport = false
          "
          class="nav-link cursor-pointer"
        >
        <i class="fa fa-check-square-o" aria-hidden="true"></i>
          <span>Accepted Invoices</span>
        </a>
      </li>

      

      <!-- Divider -->
      <hr class="sidebar-divider d-none d-md-block" />
    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
      <!-- Main Content -->
      <div id="content">
        <!-- Topbar -->
        <nav
          class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"
        >
          <!-- Sidebar Toggle (Topbar) -->
          <button
            id="sidebarToggleTop"
            class="btn btn-link d-md-none rounded-circle mr-3"
          >
            <i class="fa fa-bars"></i>
          </button>

          <!-- Topbar Navbar -->
          <ul class="navbar-nav ml-auto">
            <div class="topbar-divider d-none d-sm-block"></div>

            <!-- Nav Item - User Information -->
            <li class="nav-item">
              <a
                class="nav-link"
                id="userDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <span
                  id="username"
                  class="mr-2 d-none d-lg-inline text-gray-600 small"
                >
                  Welcome {{ username }}</span
                >
                <img
                  class="img-profile rounded-circle"
                  src="https://t4.ftcdn.net/jpg/05/89/93/27/360_F_589932782_vQAEAZhHnq1QCGu5ikwrYaQD0Mmurm0N.jpg"
                />
              </a>
              
            
            </li>
            <li>
              <button style="margin: 10px; border-radius: 50%; border: none; background-color: white;">
                <a href="http://localhost:4200" style="text-decoration: none"
                  ><i class="fa fa-sign-out fa-2x" aria-hidden="true"></i
                ></a>
              </button>
            </li>
          </ul>
        </nav>
        <!-- End of Topbar -->

        <!-- Begin Page Content -->
        <div class="container-fluid">
          <!-- Page Heading -->

          <div *ngIf="showDashboard">
            <!-- Dashboard content -->
            <!-- Content Row -->

            <div
              class="d-sm-flex align-items-center justify-content-between mb-4"
            >
              <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
              <a
                class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"
                (click)="
                  showDashboard = false;
                  showPrograms = false;
                  addPrograms = false;
                  showinvoices = false;
                  genarateReport = true
                ">
                <i class="fa fa-list-alt" aria-hidden="true"></i> Generate
                Report</a
              >
            </div>

            <div class="row">
              
              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-primary shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-primary text-uppercase mb-1"
                          style="font-size: small"
                        >
                          Disbursed Amount
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold"
                          style="color: gray; font-weight: bold"
                        >
                        <i class="fa fa-inr" aria-hidden="true"></i>{{disbursedNotNullAmount}}
                        </div>
                      </div>
                      <div class="col-auto">
                        <i
                          class="fa fa-inr fa-2x"
                          style="color: gray; font-weight: 300"
                          aria-hidden="true"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              
              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-success text-uppercase mb-1"
                          style="font-size: small"
                        >
                          Pending Amount
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold"
                          style="color: gray; font-weight: bold"
                        >
                        <i class="fa fa-inr" aria-hidden="true"></i>{{disbursedNullAmount}}
                        </div>
                      </div>
                      <div class="col-auto">
                        <i
                          class="fa fa-inr fa-2x"
                          style="color: gray; font-weight: 300"
                          aria-hidden="true"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              
              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-info shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-info text-uppercase mb-1"
                          style="font-size: small"
                        >
                          total programs
                        </div>
                        <div class="row no-gutters align-items-center">
                          <div class="col-auto">
                            <div
                              class="h5 mb-0 mr-3 font-weight-bold"
                              style="color: gray; font-weight: bold"
                            >
                              {{totalBatches}} Batches
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-auto">
                        <i
                          class="fa fa-tasks fa-2x"
                          style="color: gray; font-weight: 300"
                          aria-hidden="true"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Pending Requests Card Example -->
              <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-warning shadow h-100 py-2">
                  <div class="card-body">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div
                          class="text-xs font-weight-bold text-warning text-uppercase mb-1"
                          style="font-size: small"
                        >
                       Pending Invoices
                        </div>
                        <div
                          class="h5 mb-0 font-weight-bold"
                          style="color: gray; font-weight: bold"
                        >
                      {{pending}}  
                      </div>
                      </div>
                      <div class="col-auto">
                        <i
                          class="fa fa-files-o fa-2x"
                          style="color: gray; font-weight: 300"
                          aria-hidden="true"
                        ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-lg-8 mb-4">
              <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Overall User Activity</h6>
                </div>
                <img src="" alt="">
                <div class="card-body">
                  <img src="" alt="">
                    <h4 class="small font-weight-bold">Total Invoices Uploaded : <span
                            class="float-right">{{information.totalInvoices}}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 100%"
                            aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <h4 class="small font-weight-bold">Accepted Invoices By Me: <span
                            class="float-right">{{information.acceptedCount}}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-warning" role="progressbar" [style.width.%]="information.acceptedPercentage"
                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <h4 class="small font-weight-bold">Rejected Invoice By me: <span
                            class="float-right">{{information.rejectedCount}}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-danger" role="progressbar" [style.width.%]="information.rejectedPercentage"
                            aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <h4 class="small font-weight-bold">disbused Invoices accepted By me: <span
                            class="float-right">{{ information.disbursedCount }}</span></h4>
                    <div class="progress mb-4">
                        <div class="progress-bar bg-info" role="progressbar" [style.width.%]="information.disbursedPercentage"
                            aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            </div>
          </div>

              <!-- Pie Chart -->
              <div class="col-xl-4 col-lg-5">
                <div class="card shadow mb-4">
                  <div
                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
                  >
                    <h6 class="m-0 font-weight-bold text-primary">
                      Invoice Update Status
                    </h6>
                  </div>
                  <demo-pie-chart-seller></demo-pie-chart-seller>
                </div>
              </div>
            </div>
          </div>



          <div *ngIf="genarateReport">
            <div class="container mt-5">
              <h1>Generate Report</h1>
              <div class="row mt-4">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="startDate">Start Date:</label>
                    <input
                      type="date"
                      class="form-control"
                      id="startDate"
                      [(ngModel)]="startDate"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="endDate">End Date:</label>
                    <input
                      type="date"
                      class="form-control"
                      id="endDate"
                      [(ngModel)]="endDate"
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="reportType">Report Type:</label>
                    <select
                      class="form-control"
                      id="reportType"
                      [(ngModel)]="reportType"
                    >
                      <option value="summary">Summary Report</option>
                      <option value="detailed">Detailed Report</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-6">
                  <button
                    class="btn btn-primary"
                    (click)="generateAndDisplayReport()"
                  >
                    Generate Report
                  </button>
                  <button
                    class="btn btn-secondary ml-2"
                    (click)="exportReport('pdf')"
                  >
                    Export as PDF
                  </button>
                  <button
                    class="btn btn-secondary ml-2"
                    (click)="exportReport('csv')"
                  >
                    Export as CSV
                  </button>
                </div>
              </div>
              <div class="row mt-4" >
                <div class="col-md-12">
                 
                    <div id="reportResult">
                    
                    <div *ngIf="reportData && reportType === 'summary'" >
                      
                      <div id="usercontent" #usercontent>
                        <h2>SUMMARY REPORT</h2>
                        <p>user name: {{reportData.user.username}}</p>
                        <p>Contact: {{reportData.user.phone}}</p>
                        <p>email: {{reportData.user.email}}</p>
                        <p>Company name: {{reportData.user.companyName}}</p>
                        <table *ngIf="reportData" class="tableDiv">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>details</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                            <td>Total invoices:</td>
                            <td>
                              {{ reportData.totalInvoices }} Invoices
                            </td>
                          </tr>
                            <tr>
                              <td>Total accepted programs:</td>
                              <td>{{ reportData.totalBatchCount }} Batches</td>
                            </tr>
                            <tr>
                              <td>Total accepted invoices:</td>
                              <td>
                                {{ reportData.acceptedCount }} Invoices
                              </td>
                            </tr>
                            <tr>
                              <td>Total Disbursed Invoices:</td>
                              <td>
                                {{ reportData.disbursedCount }} Invoices
                              </td>
                            </tr>
                            <tr>
                              <td>Total Rejected RIvoices:</td>
                              <td>
                                {{ reportData.rejectedCount }} Invoices
                              </td>
                            </tr>
                            <tr>
                              <td>Accepted Invoices which are Pending to Disbursed :</td>
                              <td>
                                {{ reportData.disbursedNullCount }} Invoices
                              </td>
                            </tr>

                            <tr>
                              <td>Total Disbursed Amount:</td>
                              <td>
                                <i class="fa fa-inr" aria-hidden="true"></i>
                                {{ reportData.disbursedNotNullAmount }}
                              </td>
                            </tr>
                            <tr>
                              <td>Total pending Disbursed Amount:</td>
                              <td>
                                <i class="fa fa-inr" aria-hidden="true"></i>
                                {{ reportData.disbursedNullAmount }}
                              </td>
                            </tr>
                            
                          </tbody>
                        </table>
                      </div>

                      
                    </div>
                    <div *ngIf="reportData && reportType === 'detailed'">
                      
                      <div class="tableDiv" id="detailedcontent" #detailedcontent>
                        <h2>DETAILED REPORT</h2>
                          <p>user name: {{reportData.user.username}}</p>
                          <p>Contact: {{reportData.user.phone}}</p>
                          <p>email: {{reportData.user.email}}</p>
                          <p>Company name: {{reportData.user.companyName}}</p>
                            
                        <h2>Disbursed Invoices :</h2>
                          <table class="tableDiv" *ngIf="reportData.disbursedInvoices && reportData.disbursedInvoices.length > 0" style="margin-bottom: 25px;">
                              <!-- Table header -->
                              <thead>
                                  <tr>
                                      <th>Invoice Number</th>
                                      <th>Invoice Amount</th>
                                      <th>Batch ID</th>
                                      <th>Disbursed By</th>
                                  </tr>
                              </thead>
                              <!-- Table body -->
                              <tbody>
                                  <!-- Table rows -->
                                  <tr *ngFor="let invoice of reportData.disbursedInvoices">
                                      <td>{{ invoice.invoice_number }}</td>
                                      <td>{{ invoice.total_amount_due }}</td>
                                      <td>{{ invoice.Batch_ID.BatchID }}</td>
                                      <td>{{ invoice.disbursedByInvoice.username }}</td>
                                  </tr>
                              </tbody>
                          </table>
                          <h2>Accepted Invoices: </h2>
                          <table class="tableDiv" *ngIf="reportData.acceptedInvoices && reportData.acceptedInvoices.length > 0" style="margin-bottom: 25px;">
                              <!-- Table header -->
                              <thead>
                                  <tr>
                                      <th>Invoice Number</th>
                                      <th>Invoice Amount</th>
                                      <th>Batch ID</th>
                                      <th>Created By</th>
                                  </tr>
                              </thead>
                              <!-- Table body -->
                              <tbody>
                                  <!-- Table rows -->
                                  <tr *ngFor="let invoice of reportData.acceptedInvoices">
                                      <td>{{ invoice.invoice_number }}</td>
                                      <td>{{ invoice.total_amount_due }}</td>
                                      <td>{{ invoice.Batch_ID.BatchID }}</td>
                                      <td>{{ invoice.createdByInvoice.username }}</td>
                                  </tr>
                              </tbody>
                          </table>
                          <h2>Rejected Invoices: </h2>
                          <table class="tableDiv" *ngIf="reportData.rejectedInvoices && reportData.rejectedInvoices.length > 0" style="margin-bottom: 25px;">
                              <!-- Table header -->
                              <thead>
                                  <tr>
                                      <th>Invoice Number</th>
                                      <th>Invoice Amount</th>
                                      <th>Batch ID</th>
                                      <th>Rejected By</th>
                                  </tr>
                              </thead>
                              <!-- Table body -->
                              <tbody>
                                  <!-- Table rows -->
                                  <tr *ngFor="let invoice of reportData.rejectedInvoices">
                                      <td>{{ invoice.invoice_number }}</td>
                                      <td>{{ invoice.total_amount_due }}</td>
                                      <td>{{ invoice.Batch_ID.BatchID }}</td>
                                      <td>{{ invoice.rejectedByInvoice.username }}</td>
                                  </tr>
                              </tbody>
                          </table>
                          <h2>all accepted whole Batches</h2>
                          <table class="tableDiv" *ngIf="reportData.batches && reportData.batches.length > 0" style="margin-bottom: 25px;">
                              <!-- Table header -->
                              <thead>
                                  <tr>
                                      <th>Batch ID</th>
                                      <th>Program Type</th>
                                      <th>Region</th>
                                      <th>Status</th>
                                      <th>Created By</th>
                                      <th>Disbursed By</th>
                                      <th>Rejected By</th>
                                  </tr>
                              </thead>
                              <!-- Table body -->
                              <tbody>
                                  <!-- Table rows -->
                                  <tr *ngFor="let batch of reportData.batches">
                                      <td>{{ batch.BatchID }}</td>
                                      <td>{{ batch.programType }}</td>
                                      <td>{{ batch.region }}</td>
                                      <td>{{ batch.status }}</td>
                                      <td>{{ batch.acceptedBy ? batch.acceptedBy.username : null }}</td>
                                      <td>{{ batch.disbursedBy ? batch.disbursedBy.username : null }}</td>
                                      <td>{{ batch.rejectedBy ? batch.rejectedBy.username : null}}</td>
                                  </tr>
                              </tbody>
                          </table>
                    </div>
                  </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="addPrograms">
            <div >
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
               
              </div>
  

              <div class="serchMain">
                <div class="search-box">
                  <div class="form-group1" id="limit">
                    <label for="limit">Entries per page: </label>
                    <select
                      id="status"
                      [(ngModel)]="limit"
                      class="form-control"
                      (click)="getInvoiceData(parameterBatchID)"
                    >
                      <option value="5">5</option>
                      <option value="10">10</option>
                      <option value="15">15</option>
                      <option value="20">20</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="BatchID">Invoice Number:</label>
                    <input
                      type="text"
                      id="invoice_number"
                      [(ngModel)]="invoice_number"
                      class="form-control"
                    />
                  </div>
                  <div class="form-group">
                    <label for="BatchID">Customer Name:</label>
                    <input
                      type="text"
                      id="customer_name"
                      [(ngModel)]="customer_name"
                      class="form-control"
                    />
                  </div>
                  <div class="form-group">
                    <label for="status">Status:</label>
                    <select id="status" [(ngModel)]="status" class="form-control">
                      <option value="">Select Status</option>
                      <option value="uploaded">Uploaded</option>
                      <option value="accepted">Accepted</option>
                      <option value="rejected">Rejected</option>
                      <option value="disbursed">Disbursed</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <button
                      class="btn btn-primary"
                      type="button"
                      (click)="getInvoiceData(parameterBatchID)"
                    >
                      <i class="fa fa-search"></i>
                    </button>
                  </div>
                </div>
              </div>


              <div id="tableDiv">
                <table>
                  <thead>
                    <tr>
                      <td></td>
                      <th>ID</th>
                      <th (click)="sortInvoices('invoice_number')">
                        Invoice Number
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'invoice_number' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th>Batch_ID</th>
                      <!-- <th></th> -->
                      <th (click)="sortInvoices('invoice_date')">
                        Invoice Date
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'invoice_date' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th (click)="sortInvoices('due_date')">
                        Due Date
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'due_date' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th (click)="sortInvoices('description')">
                        Description
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'description' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th (click)="sortInvoices('total_amount_due')">
                        Invoice Amount
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'total_amount_due' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th (click)="sortInvoices('unit_price')">
                        Unit Price
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'unit_price' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      <th (click)="sortInvoices('status')">
                        Status
                        <i
                          class="fa fa-sort-alpha-{{
                            sortBy === 'status' ? sortDirection : 'asc'
                          }}"
                          aria-hidden="true"
                        ></i>
                      </th>
                      
                        <th>Created By</th>
                        <th>Disbursed by</th>
                        <th>Rejected By</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container
                      *ngFor="
                        let invoice of invoices;
                        let i = index;
                        trackBy: invoice.id
                      "
                    >
                      <tr>
                        <td id="plus">
                          <i
                            class="fa fa-plus"
                            aria-hidden="true"
                            (click)="toggleInvoiceDetails(i, invoice.id)"
                          ></i>
                        </td>
                        <td>{{ invoice.id }}</td>
                        <td>{{ invoice.invoice_number }}</td>
                        <td>{{ invoice.Batch_ID.BatchID }}</td>
                        <td>{{ invoice.invoice_date }}</td>
                        <td>{{ invoice.due_date }}</td>
                        <td>{{ invoice.description }}</td>
                        <td>{{ invoice.total_amount_due }}</td>
                        <td>{{ invoice.unit_price }}</td>
                        <td>
                          <button [ngClass]="getStatusClass(invoice.status)">
                            {{ invoice.status }}
                          </button>
                        </td>
                        <td>
                          {{
                            invoice.createdByInvoice
                              ? invoice.createdByInvoice.username
                              : null
                          }}
                        </td>
                        <td>
                          {{
                            invoice.disbursedByInvoice
                              ? invoice.disbursedByInvoice.username
                              : null
                          }}
                        </td>
                        <td>
                          {{
                            invoice.rejectedByInvoice
                              ? invoice.rejectedByInvoice.username
                              : null
                          }}
                        </td>
                        <td>
                          <button
                            *ngIf="invoice.status === 'rejected'"
                            type="button"
                            class="btn btn-outline-danger action"
                            disabled
                          >
                            <i class="fa fa-times" aria-hidden="true"></i>
                            Rejected
                          </button>
                          <button
                            *ngIf="invoice.status === 'accepted'"
                            type="button"
                            class="btn btn-outline-warning action"
                            disabled
                          >
                            <i
                              class="fa fa-check-square-o"
                              aria-hidden="true"
                            ></i>
                            Accepted
                          </button>
                          <button
                              *ngIf="invoice.status === 'disbursed'"
                              type="button"
                              class="btn btn-outline-success action"
                              disabled
                            >
                              <i
                                class="fa fa-check-square-o"
                                aria-hidden="true"
                              ></i>
                              Disbursed
                              </button>
                        </td>
                      </tr>
                      <tr *ngIf="expandedIndex === i">
                        <td colspan="15">
                          <h5>invoice number: {{ invoice.invoice_number }}</h5>
                          <h6>customer Name: {{ invoice.customer_name }}</h6>
                          <h6>
                            customer contact: {{ invoice.customer_contact }}
                          </h6>
                          <h6>company name: {{ invoice.company_name }}</h6>
                          <h6>company contact: {{ invoice.company_contact }}</h6>
                          <h6>quantity: {{ invoice.quantity }}</h6>
                          <h6>unit price: {{ invoice.company_name }}</h6>
                          <h6>tax rate: {{ invoice.tax_rate }}</h6>
                          <h6>tax amount: {{ invoice.tax_amount }}</h6>
                          <h6>
                            total amount due: {{ invoice.total_amount_due }}
                          </h6>
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
              <div class="pagination-container">
                <div class="pagination-left">
                  <span>
                    Showing {{ startIndex }} to {{ endIndex }} of
                    {{ pagination?.totalEntries }} entries
                  </span>
                </div>
                <div class="pagination-right">
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="goToFirstPageSeller()"
                    [disabled]="pagination?.currentPage === 1"
                  >
                    <i class="fa fa-fast-backward" aria-hidden="true"></i>
                  </button>
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="prevPageSeller()"
                    [disabled]="pagination?.currentPage === 1"
                  >
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                  </button>
                  <span *ngIf="pagination">
                    Page {{ pagination.currentPage }} of
                    {{ pagination.totalPages }}
                  </span>
  
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="nextPageSeller()"
                    [disabled]="!pagination?.hasNextPage"
                  >
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                  </button>
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="goToLastPageSeller()"
                    [disabled]="
                    pagination?.currentPage === pagination?.totalPages
                    "
                  >
                    <i class="fa fa-fast-forward" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="showPrograms">
            <div class="serchMain">
              <div class="search-box">
                <div class="form-group1" id="limit">
                  <label for="limit">Entries per Page:</label>
                  <select
                    id="status"
                    [(ngModel)]="limit"
                    class="form-control"
                    (click)="refreshData()"
                  >
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="BatchID">Batch ID:</label>
                  <input
                    type="text"
                    id="BatchID"
                    [(ngModel)]="BatchID"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <label for="status">Region:</label>
                  <select id="status" [(ngModel)]="region" class="form-control">
                    <option value="">Select Reigon</option>
                    <option value="south">South</option>
                    <option value="north">North</option>
                    <option value="east">East</option>
                    <option value="west">West</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="status">Program Type:</label>
                  <select
                    id="status"
                    [(ngModel)]="programType"
                    class="form-control"
                  >
                    <option value="">Select Program Type</option>
                    <option value="vender program">Vender Program</option>
                    <option value="dealer program">Dealer Program</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="status">Status:</label>
                  <select id="status" [(ngModel)]="status" class="form-control">
                    <option value="">Select Status</option>
                    <option value="uploaded">Uploaded</option>
                    <option value="partially accepted">
                      Partially Accepted
                    </option>
                    <option value="accepted">Accepted</option>
                    <option value="rejected">Rejected</option>
                    <option value="disbursed">Disbursed</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="fileName">File Name:</label>
                  <input
                    type="text"
                    id="fileName"
                    [(ngModel)]="fileName"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <button
                    class="btn btn-primary"
                    type="button"
                    (click)="refreshData()"
                  >
                    <i class="fa fa-search"></i>
                  </button>
                </div>
              </div>
            </div>

            <div id="tableDiv">
              <table *ngIf="batchTable">
                <thead>
                  <tr>
                    <th>#</th>
                    <th (click)="sortData('BatchID')">
                      Batch ID
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'BatchID' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortData('name')">
                      Name
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'name' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortData('pancard')">
                      Pan
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'pancard' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortData('region')">
                      Region
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'region' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th>Type</th>
                    <th>Invoice FIle</th>
                    <th (click)="sortData('status')">
                      Status
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'status' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th>Created At</th>
                    <th>Created by</th>
                    <th>disbursed by</th>
                    
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let batch of batches; trackBy: trackByFn">
                    <td>{{ batch.id }}</td>
                    <td>{{ batch.BatchID }}</td>
                    <td>{{ batch.name }}</td>
                    <td>{{ batch.pancard }}</td>
                    <td>{{ batch.region }}</td>
                    <td>{{ batch.programType }}</td>
                    <td>
                      <a
                        href="http://localhost:8080/download/{{ batch.id }}"
                        download=""
                        ><i class="fa fa-download" aria-hidden="true"></i></a
                      >
                    </td>
                    <td>
                      <button [ngClass]="getStatusClass(batch.status)">
                        {{ batch.status }}
                      </button>
                    </td>
                    <td>{{ batch.createdAt }}</td>
                    <td>{{ batch.createdBy ? batch.createdBy.username : null }}</td>
                    <td>{{ batch.disbursedBy ? batch.disbursedBy.username : null }}</td>
                    <td>
                      <button
                        type="button"
                        class="btn btn-outline-info action"
                        (click)="
                          getInvoiceData(batch.id);
                          showinvoices = true;
                          addPrograms = false;
                          showPrograms = false;
                          showDashboard = false
                        "
                      >
                        <i class="fa fa-eye" aria-hidden="true"></i>
                      </button>
                    </td>
                    
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-container">
              <div class="pagination-left">
                <span>
                  Showing {{ startIndex }} to {{ endIndex }} of
                  {{ pagination?.totalEntries }} entries
                </span>
              </div>
              <div class="pagination-right">
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="goToFirstPage()"
                  [disabled]="pagination?.currentPage === 1"
                >
                  <i class="fa fa-fast-backward" aria-hidden="true"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="prevPage()"
                  [disabled]="pagination?.currentPage === 1"
                >
                  <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </button>
                <span *ngIf="pagination">
                  Page {{ pagination.currentPage }} of
                  {{ pagination.totalPages }}
                </span>

                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="nextPage()"
                  [disabled]="!pagination?.hasNextPage"
                >
                  <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="goToLastPage()"
                  [disabled]="
                    pagination?.currentPage === pagination?.totalPages
                  "
                >
                  <i class="fa fa-fast-forward" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="showinvoices">
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
              <button
                class="btn btn-primary"
                (click)="
                  showPrograms = true;
                  showinvoices = false;
                  showDashboard = false;
                  addPrograms = false
                "
              >
                <i class="fa fa-undo" aria-hidden="true"></i> Go back
              </button>
            </div>

            <!-- <div class="row pt-3">
              <div class="col text-center">
                <h3>Invoices</h3>
              </div>
            </div> -->
            <div class="serchMain">
              <div class="search-box">
                <div class="form-group1" id="limit">
                  <label for="limit">Entries per page: </label>
                  <select
                    id="status"
                    [(ngModel)]="limit"
                    class="form-control"
                    (click)="getInvoiceData(parameterBatchID)"
                  >
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="BatchID">Invoice Number:</label>
                  <input
                    type="text"
                    id="invoice_number"
                    [(ngModel)]="invoice_number"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <label for="BatchID">Customer Name:</label>
                  <input
                    type="text"
                    id="customer_name"
                    [(ngModel)]="customer_name"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <label for="status">Status:</label>
                  <select id="status" [(ngModel)]="status" class="form-control">
                    <option value="">Select Status</option>
                    <option value="uploaded">Uploaded</option>
                    <option value="accepted">Accepted</option>
                    <option value="rejected">Rejected</option>
                    <option value="disbursed">Disbursed</option>
                  </select>
                </div>
                <div class="form-group">
                  <button
                    class="btn btn-primary"
                    type="button"
                    (click)="getInvoiceData(parameterBatchID)"
                  >
                    <i class="fa fa-search"></i>
                  </button>
                </div>
              </div>

              <div
                id="uploadBox"
                *ngIf="uploadStatus === 'success'"
                class="alert alert-success"
                role="alert"
              >
                DATA IS NOT AVAILABLE
              </div>
            </div>
            <div id="tableDiv">
              <table>
                <thead>
                  <tr>
                    <td></td>
                    <th>ID</th>
                    <th (click)="sortInvoices('invoice_number')">
                      Invoice Number
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'invoice_number' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th>Batch_ID</th>
                    <th (click)="sortInvoices('invoice_date')">
                      Invoice Date
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'invoice_date' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortInvoices('due_date')">
                      Due Date
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'due_date' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortInvoices('description')">
                      Description
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'description' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortInvoices('total_amount_due')">
                      Invoice Amount
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'total_amount_due' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortInvoices('unit_price')">
                      Unit Price
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'unit_price' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    <th (click)="sortInvoices('status')">
                      Status
                      <i
                        class="fa fa-sort-alpha-{{
                          sortBy === 'status' ? sortDirection : 'asc'
                        }}"
                        aria-hidden="true"
                      ></i>
                    </th>
                    
                        <th>Accepted By</th>
                        <th>disbursed By</th>
                        <th>Rejected By</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container
                    *ngFor="
                      let invoice of invoices;
                      let i = index;
                      trackBy: invoice.id
                    "
                  >
                    <tr>
                      <td id="plus">
                        <i
                          class="fa fa-plus"
                          aria-hidden="true"
                          (click)="toggleInvoiceDetails(i, invoice.id)"
                        ></i>
                      </td>
                      <td>{{ invoice.id }}</td>
                      <td style="color: #4e73df; font-weight: 700;">{{ invoice.invoice_number }}</td>
                      <td>{{ BatchID }}</td>
                      <td>{{ invoice.invoice_date }}</td>
                      <td>{{ invoice.due_date }}</td>
                      <td>{{ invoice.description }}</td>
                      <td>{{ invoice.total_amount_due }}</td>
                      <td>{{ invoice.unit_price }}</td>
                      <td>
                        <button [ngClass]="getStatusClass(invoice.status)">
                          {{ invoice.status }}
                        </button>
                      </td>
                     
                      <td>
                        {{
                          invoice.acceptedByInvoice
                            ? invoice.acceptedByInvoice.username
                            : null
                        }}
                      </td>
                      <td>
                        {{
                          invoice.disbursedByInvoice
                            ? invoice.disbursedByInvoice.username
                            : null
                        }}
                      </td>
                      <td>
                        {{
                          invoice.rejectedByInvoice
                            ? invoice.rejectedByInvoice.username
                            : null
                        }}
                      </td>
                      <td>
                        <button
                            *ngIf="invoice.status !== 'rejected' && invoice.status !== 'disbursed' && invoice.status !== 'accepted' && invoice.status !== 'rejected'"
                            type="button"
                            class="btn btn-outline-warning action"
                            (click)="openModelaccept(i)"
                          >
                            <i
                              class="fa fa-check-square-o"
                              aria-hidden="true"
                            ></i>
                          </button>
                          <button
                          *ngIf="invoice.status !== 'rejected' && invoice.status !== 'disbursed' && invoice.status !== 'rejected' && invoice.status !== 'accepted'"
                            type="button"
                            class="btn btn-outline-danger action"
                            (click)="openModelReject(i)"
                          >
                            <i class="fa fa-times" aria-hidden="true"></i>
                          </button>
                            <button
                              *ngIf="invoice.status === 'rejected'"
                              type="button"
                              class="btn btn-outline-danger action"
                              disabled
                            >
                              <i class="fa fa-times" aria-hidden="true"></i>
                              Rejected
                            </button>
                            <button
                              *ngIf="invoice.status === 'disbursed'"
                              type="button"
                              class="btn btn-outline-success action"
                              disabled
                            >
                              <i
                                class="fa fa-check-square-o"
                                aria-hidden="true"
                              ></i>
                              disbursed
                            </button>
                            <button
                              *ngIf="invoice.status === 'accepted'"
                              type="button"
                              class="btn btn-outline-warning action"
                              disabled
                            >
                              <i
                                class="fa fa-check-square-o"
                                aria-hidden="true"
                              ></i>
                              accepted
                            </button>
                      </td>
                      <div class="modal" tabindex="-1" id="myModalAccept" #myModalAccept>
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="closeModelAccept()"></button>
                            </div>
                            <div class="modal-body">
                              <h5>Are you sure you want to accept this invoice ?</h5>
                            </div>
                            <div class="modal-footer">
                              <button type="button" id="accept" class="btn btn-success" data-bs-dismiss="modal" (click)="acceptInvoice()">Yes</button>
                              <button type="button" class="btn btn-danger" (click)="closeModelAccept()">No</button>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="modal" tabindex="-1" id="myModalReject" #myModalReject>
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="closeModelReject()"></button>
                            </div>
                            <div class="modal-body">
                              <h5>Are you sure you want to Reject this invoice ?</h5>
                            </div>
                            <div class="modal-footer">
                              <button type="button" id="accept" class="btn btn-success" data-bs-dismiss="modal" (click)="rejectInvoice()">Yes</button>
                              <button type="button" class="btn btn-danger" (click)="closeModelReject()">No</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </tr>
                    <tr *ngIf="expandedIndex === i">
                      <td colspan="15">
                        <h5>invoice number: {{ invoice.invoice_number }}</h5>
                        <h6>customer Name: {{ invoice.customer_name }}</h6>
                        <h6>
                          customer contact: {{ invoice.customer_contact }}
                        </h6>
                        <h6>company name: {{ invoice.company_name }}</h6>
                        <h6>company contact: {{ invoice.company_contact }}</h6>
                        <h6>quantity: {{ invoice.quantity }}</h6>
                        <h6>unit price: {{ invoice.company_name }}</h6>
                        <h6>tax rate: {{ invoice.tax_rate }}</h6>
                        <h6>tax amount: {{ invoice.tax_amount }}</h6>
                        <h6>
                          total amount due: {{ invoice.total_amount_due }}
                        </h6>
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
            <div class="pagination-container">
              <div class="pagination-left">
                <span>
                  Showing {{ startIndex }} to {{ endIndex }} of
                  {{ pagination?.totalEntries }} entries
                </span>
              </div>
              <div class="pagination-right">
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="goToFirstPage()"
                  [disabled]="pagination?.currentPage === 1"
                >
                  <i class="fa fa-fast-backward" aria-hidden="true"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="prevPage()"
                  [disabled]="pagination?.currentPage === 1"
                >
                  <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </button>
                <span *ngIf="pagination">
                  Page {{ pagination.currentPage }} of
                  {{ pagination.totalPages }}
                </span>

                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="nextPage()"
                  [disabled]="!pagination?.hasNextPage"
                >
                  <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  (click)="goToLastPage()"
                  [disabled]="
                    pagination?.currentPage === pagination?.totalPages
                  "
                >
                  <i class="fa fa-fast-forward" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- /.container-fluid -->
      </div>
      <!-- End of Main Content -->
    </div>
    <!-- End of Content Wrapper -->
  </div>
  <!-- End of Page Wrapper -->
</body>
